<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Multiple Regression with Multivariate Adaptive Shrinkage. — mr.mash • mr.mash.alpha</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Multiple Regression with Multivariate Adaptive Shrinkage. — mr.mash"><meta property="og:description" content="Performs multivariate multiple regression with
  mixture-of-normals prior."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mr.mash.alpha</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2-26</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/stephenslab/mr.mash.alpha" class="external-link">Source</a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Multiple Regression with Multivariate Adaptive Shrinkage.</h1>
    <small class="dont-index">Source: <a href="https://github.com/stephenslab/mr.mash.alpha/blob/HEAD/R/mr_mash.R" class="external-link"><code>R/mr_mash.R</code></a></small>
    <div class="hidden name"><code>mr.mash.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Performs multivariate multiple regression with
  mixture-of-normals prior.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mr.mash</span><span class="op">(</span></span>
<span>  <span class="va">X</span>,</span>
<span>  <span class="va">Y</span>,</span>
<span>  <span class="va">S0</span>,</span>
<span>  w0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S0</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  V <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mu1_init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  convergence_criterion <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mu1"</span>, <span class="st">"ELBO"</span><span class="op">)</span>,</span>
<span>  max_iter <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>  update_w0 <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  update_w0_method <span class="op">=</span> <span class="st">"EM"</span>,</span>
<span>  w0_threshold <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  compute_ELBO <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  standardize <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  update_V <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  update_V_method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"full"</span>, <span class="st">"diagonal"</span><span class="op">)</span>,</span>
<span>  version <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Rcpp"</span>, <span class="st">"R"</span><span class="op">)</span>,</span>
<span>  e <span class="op">=</span> <span class="fl">1e-08</span>,</span>
<span>  ca_update_order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"consecutive"</span>, <span class="st">"decreasing_logBF"</span>, <span class="st">"increasing_logBF"</span><span class="op">)</span>,</span>
<span>  nthreads <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>X</dt>
<dd><p>n x p matrix of covariates.</p></dd>


<dt>Y</dt>
<dd><p>n x r matrix of responses.</p></dd>


<dt>S0</dt>
<dd><p>List of length K containing the desired r x r prior
covariance matrices on the regression coefficients.</p></dd>


<dt>w0</dt>
<dd><p>K-vector with prior mixture weights, each associated with
the respective covariance matrix in <code>S0</code>.</p></dd>


<dt>V</dt>
<dd><p>r x r residual covariance matrix.</p></dd>


<dt>mu1_init</dt>
<dd><p>p x r matrix of initial estimates of the posterior
mean regression coefficients. These should be on the same scale as
the X provided. If <code>standardize=TRUE</code>, mu1_init will be scaled
appropriately after standardizing X.</p></dd>


<dt>tol</dt>
<dd><p>Convergence tolerance.</p></dd>


<dt>convergence_criterion</dt>
<dd><p>Criterion to use for convergence check.</p></dd>


<dt>max_iter</dt>
<dd><p>Maximum number of iterations for the optimization
algorithm.</p></dd>


<dt>update_w0</dt>
<dd><p>If <code>TRUE</code>, prior weights are updated.</p></dd>


<dt>update_w0_method</dt>
<dd><p>Method to update prior weights. Only EM is
currently supported.</p></dd>


<dt>w0_threshold</dt>
<dd><p>Drop mixture components with weight less than this value.
Components are dropped at each iteration after 15 initial iterations.
This is done to prevent from dropping some poetentially important 
components prematurely.</p></dd>


<dt>compute_ELBO</dt>
<dd><p>If <code>TRUE</code>, ELBO is computed.</p></dd>


<dt>standardize</dt>
<dd><p>If <code>TRUE</code>, X is "standardized" using the
sample means and sample standard deviations. Standardizing X
allows a faster implementation, but the prior has a different
interpretation. Coefficients and covariances are returned on the
original scale.</p></dd>


<dt>verbose</dt>
<dd><p>If <code>TRUE</code>, some information about the
algorithm's process is printed at each iteration.</p></dd>


<dt>update_V</dt>
<dd><p>if <code>TRUE</code>, residual covariance is updated.</p></dd>


<dt>update_V_method</dt>
<dd><p>Method to update residual covariance. So far,
"full" and "diagonal" are supported. If <code>update_V=TRUE</code> and V 
is not provided by the user, this option will determine how V is 
computed (and fixed) internally from <code>mu1_init</code>.</p></dd>


<dt>version</dt>
<dd><p>Whether to use R or C++ code to perform the
coordinate ascent updates.</p></dd>


<dt>e</dt>
<dd><p>A small number to add to the diagonal elements of the
prior matrices to improve numerical stability of the updates.</p></dd>


<dt>ca_update_order</dt>
<dd><p>The order with which coordinates are
updated.  So far, "consecutive", "decreasing_logBF",
"increasing_logBF" are supported.</p></dd>


<dt>nthreads</dt>
<dd><p>Number of RcppParallel threads to use for the
updates. When <code>nthreads</code> is <code>NA</code>, the default number of
threads is used; see
<code><a href="https://rdrr.io/pkg/RcppParallel/man/setThreadOptions.html" class="external-link">defaultNumThreads</a></code>. This setting is
ignored when <code>version = "R"</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A mr.mash fit, stored as a list with some or all of the
following elements:</p>
<dl><dt>mu1</dt>
<dd><p>p x r matrix of posterior means for the regression
  coeffcients.</p></dd>


<dt>S1</dt>
<dd><p>r x r x p array of posterior covariances for the
  regression coeffcients.</p></dd>


<dt>w1</dt>
<dd><p>p x K matrix of posterior assignment probabilities to the
  mixture components.</p></dd>

  
<dt>V</dt>
<dd><p>r x r residual covariance matrix</p></dd>


<dt>w0</dt>
<dd><p>K-vector with (updated, if <code>update_w0=TRUE</code>) prior mixture weights, each associated with
  the respective covariance matrix in <code>S0</code></p></dd>
</dl><p>.</p>
<dl><dt>S0</dt>
<dd><p>r x r x K array of prior covariance matrices
  on the regression coefficients</p></dd>
</dl><p>.</p>
<dl><dt>intercept</dt>
<dd><p>r-vector containing posterior mean estimate of the
  intercept.</p></dd>


<dt>fitted</dt>
<dd><p>n x r matrix of fitted values.</p></dd>


<dt>G</dt>
<dd><p>r x r covariance matrix of fitted values.</p></dd>


<dt>pve</dt>
<dd><p>r-vector of proportion of variance explained by the covariates.</p></dd>


<dt>ELBO</dt>
<dd><p>Evidence Lower Bound (ELBO) at last iteration.</p></dd>


<dt>progress</dt>
<dd><p>A data frame including information regarding
  convergence criteria at each iteration.</p></dd>

  
<dt>converged</dt>
<dd><p><code>TRUE</code> or <code>FALSE</code>, indicating whether
  the optimization algorithm converged to a solution within the chosen tolerance
  level.</p></dd>

  
<dt>Y</dt>
<dd><p>n x r matrix of responses at last iteration (only relevant when missing values
  are present in the input Y).</p></dd>

</dl></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">###Set seed</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###Simulate X and Y</span></span></span>
<span class="r-in"><span><span class="co">##Set parameters</span></span></span>
<span class="r-in"><span><span class="va">n</span>  <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="va">p_causal</span> <span class="op">&lt;-</span> <span class="fl">20</span></span></span>
<span class="r-in"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fl">5</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###Simulate data</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="simulate_mr_mash_data.html">simulate_mr_mash_data</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">p</span>, <span class="va">p_causal</span>, <span class="va">r</span>, pve<span class="op">=</span><span class="fl">0.5</span>, B_cor<span class="op">=</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>                             B_scale<span class="op">=</span><span class="fl">1</span>, X_cor<span class="op">=</span><span class="fl">0</span>, X_scale<span class="op">=</span><span class="fl">1</span>, V_cor<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###Split the data in training and test sets</span></span></span>
<span class="r-in"><span><span class="va">Ytrain</span> <span class="op">&lt;-</span> <span class="va">out</span><span class="op">$</span><span class="va">Y</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">200</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">Xtrain</span> <span class="op">&lt;-</span> <span class="va">out</span><span class="op">$</span><span class="va">X</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">200</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">Ytest</span> <span class="op">&lt;-</span> <span class="va">out</span><span class="op">$</span><span class="va">Y</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">200</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">Xtest</span> <span class="op">&lt;-</span> <span class="va">out</span><span class="op">$</span><span class="va">X</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">200</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###Specify the covariance matrices for the mixture-of-normals prior.</span></span></span>
<span class="r-in"><span><span class="va">univ_sumstats</span> <span class="op">&lt;-</span> <span class="fu"><a href="compute_univariate_sumstats.html">compute_univariate_sumstats</a></span><span class="op">(</span><span class="va">Xtrain</span>, <span class="va">Ytrain</span>,</span></span>
<span class="r-in"><span>                   standardize<span class="op">=</span><span class="cn">TRUE</span>, standardize.response<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="autoselect.mixsd.html">autoselect.mixsd</a></span><span class="op">(</span><span class="va">univ_sumstats</span>, mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">S0</span> <span class="op">&lt;-</span> <span class="fu"><a href="compute_canonical_covs.html">compute_canonical_covs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Ytrain</span><span class="op">)</span>, singletons<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                             hetgrid<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">S0</span> <span class="op">&lt;-</span> <span class="fu"><a href="expand_covs.html">expand_covs</a></span><span class="op">(</span><span class="va">S0</span>, <span class="va">grid</span>, zeromat<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###Fit mr.mash</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">mr.mash</span><span class="op">(</span><span class="va">Xtrain</span>, <span class="va">Ytrain</span>, <span class="va">S0</span>, update_V<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Processing the inputs... Done!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting the optimization algorithm using 8 RcppParallel threads... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  iter    mu1_max.diff     ELBO_diff               ELBO</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1       1.71e+00            Inf      -1.17642528220990207046e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2       3.16e-01       3.86e+02      -1.13785636762104713853e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3       7.32e-02       2.38e+01      -1.13547399116407923430e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4       2.64e-02       2.75e+00      -1.13519874874270262808e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5       1.63e-02       1.28e+00      -1.13507113822810133570e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    6       1.23e-02       7.76e-01      -1.13499353149131511600e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    7       9.55e-03       5.23e-01      -1.13494120998063335719e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    8       7.63e-03       3.77e-01      -1.13490351417299498280e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    9       6.23e-03       2.85e-01      -1.13487496678169627558e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   10       5.18e-03       2.25e-01      -1.13485247734950498852e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   11       4.38e-03       1.83e-01      -1.13483418476869410370e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   12       3.76e-03       1.53e-01      -1.13481890954040354700e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   13       3.27e-03       1.30e-01      -1.13480587207075150218e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   14       2.87e-03       1.13e-01      -1.13479453863624330552e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   15       2.54e-03       1.00e-01      -1.13478453286182557349e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   16       2.27e-03       8.95e-02      -1.13477558262726124667e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   17       2.05e-03       8.10e-02      -1.13476748699693489471e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   18       1.86e-03       7.39e-02      -1.13476009491374643403e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   19       1.70e-03       6.80e-02      -1.13475329105017372058e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   20       1.56e-03       6.30e-02      -1.13474698615490669908e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   21       1.44e-03       5.88e-02      -1.13474111030748626945e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   22       1.34e-03       5.50e-02      -1.13473560810572562332e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   23       1.24e-03       5.17e-02      -1.13473043517017777049e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   24       1.16e-03       4.88e-02      -1.13472555556662573508e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   25       1.15e-03       4.62e-02      -1.13472093988159122091e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   26       1.14e-03       4.38e-02      -1.13471656377071776660e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   27       1.13e-03       4.16e-02      -1.13471240685484717687e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   28       1.11e-03       3.95e-02      -1.13470845187506129150e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   29       1.09e-03       3.77e-02      -1.13470468404263901903e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   30       1.06e-03       3.59e-02      -1.13470109053693431633e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   31       1.03e-03       3.43e-02      -1.13469766011625943065e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   32       9.99e-04       3.28e-02      -1.13469438281548755185e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   33       9.66e-04       3.13e-02      -1.13469124971045657730e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   34       9.32e-04       3.00e-02      -1.13468825273393031239e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   35       8.97e-04       2.87e-02      -1.13468538453142646176e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   36       8.62e-04       2.75e-02      -1.13468263834788249369e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   37       8.45e-04       2.63e-02      -1.13468000793820210674e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   38       8.27e-04       2.52e-02      -1.13467748749628517544e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   39       8.08e-04       2.42e-02      -1.13467507159838860389e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   40       7.88e-04       2.32e-02      -1.13467275515757955873e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   41       7.69e-04       2.22e-02      -1.13467053338681453170e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   42       7.48e-04       2.13e-02      -1.13466840176871337462e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   43       7.28e-04       2.05e-02      -1.13466635603056383843e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   44       7.08e-04       1.96e-02      -1.13466439212341210805e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   45       6.87e-04       1.89e-02      -1.13466250620438004262e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   46       6.67e-04       1.81e-02      -1.13466069462152881897e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   47       6.46e-04       1.74e-02      -1.13465895390076802869e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   48       6.26e-04       1.67e-02      -1.13465728073440150183e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   49       6.06e-04       1.61e-02      -1.13465567197101463535e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   50       5.86e-04       1.55e-02      -1.13465412460646330146e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   51       5.67e-04       1.49e-02      -1.13465263577577770775e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   52       5.48e-04       1.43e-02      -1.13465120274583478022e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   53       5.29e-04       1.38e-02      -1.13464982290868847485e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   54       5.10e-04       1.33e-02      -1.13464849377545324387e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   55       4.92e-04       1.28e-02      -1.13464721297067571868e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   56       4.74e-04       1.23e-02      -1.13464597822712294146e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   57       4.57e-04       1.19e-02      -1.13464478738093566790e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   58       4.40e-04       1.15e-02      -1.13464363836710472242e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   59       4.23e-04       1.11e-02      -1.13464252921522602264e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   60       4.07e-04       1.07e-02      -1.13464145804550516914e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   61       3.91e-04       1.03e-02      -1.13464042306498577091e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   62       3.76e-04       1.00e-02      -1.13463942256396603625e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   63       3.61e-04       9.68e-03      -1.13463845491259417031e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   64       3.47e-04       9.36e-03      -1.13463751855761802290e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   65       3.32e-04       9.07e-03      -1.13463661201927116053e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   66       3.19e-04       8.78e-03      -1.13463573388829008763e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   67       3.06e-04       8.51e-03      -1.13463488282303715096e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   68       2.93e-04       8.25e-03      -1.13463405754673603951e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   69       2.80e-04       8.01e-03      -1.13463325684479787014e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   70       2.68e-04       7.77e-03      -1.13463247956223913206e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   71       2.57e-04       7.55e-03      -1.13463172460118166782e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   72       2.45e-04       7.34e-03      -1.13463099091843414499e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   73       2.34e-04       7.13e-03      -1.13463027752314555983e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   74       2.24e-04       6.94e-03      -1.13462958347453786700e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   75       2.14e-04       6.76e-03      -1.13462890787970027304e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   76       2.04e-04       6.58e-03      -1.13462824989146174630e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   77       1.95e-04       6.41e-03      -1.13462760870632264414e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   78       1.86e-04       6.25e-03      -1.13462698356246091862e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   79       1.80e-04       6.10e-03      -1.13462637373779398331e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   80       1.74e-04       5.95e-03      -1.13462577854811788711e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   81       1.69e-04       5.81e-03      -1.13462519734529741982e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   82       1.65e-04       5.68e-03      -1.13462462951552934101e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   83       1.60e-04       5.55e-03      -1.13462407447766581754e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   84       1.55e-04       5.43e-03      -1.13462353168159825145e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   85       1.51e-04       5.31e-03      -1.13462300060670477251e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   86       1.47e-04       5.20e-03      -1.13462248076035775739e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   87       1.43e-04       5.09e-03      -1.13462197167649392213e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   88       1.38e-04       4.99e-03      -1.13462147291423789284e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   89       1.35e-04       4.89e-03      -1.13462098405659016862e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   90       1.31e-04       4.79e-03      -1.13462050470916674385e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   91       1.27e-04       4.70e-03      -1.13462003449899821135e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   92       1.23e-04       4.61e-03      -1.13461957307338107057e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   93       1.20e-04       4.53e-03      -1.13461912009878160461e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   94       1.17e-04       4.45e-03      -1.13461867525979323545e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   95       1.13e-04       4.37e-03      -1.13461823825814226439e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   96       1.10e-04       4.29e-03      -1.13461780881174290698e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   97       1.13e-04       4.22e-03      -1.13461738665379671147e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   98       1.17e-04       4.15e-03      -1.13461697153194236307e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   99       1.20e-04       4.08e-03      -1.13461656320744168625e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  100       1.23e-04       4.02e-03      -1.13461616145441457775e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  101       1.25e-04       3.95e-03      -1.13461576605910940998e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  102       1.28e-04       3.89e-03      -1.13461537681921363401e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  103       1.30e-04       3.83e-03      -1.13461499354320185375e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  104       1.32e-04       3.77e-03      -1.13461461604971573252e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  105       1.34e-04       3.72e-03      -1.13461424416698519053e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  106       1.36e-04       3.66e-03      -1.13461387773226997524e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  107       1.38e-04       3.61e-03      -1.13461351659134415968e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  108       1.40e-04       3.56e-03      -1.13461316059800064977e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  109       1.41e-04       3.51e-03      -1.13461280961358843342e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  110       1.43e-04       3.46e-03      -1.13461246350657256698e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  111       1.44e-04       3.41e-03      -1.13461212215212126466e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  112       1.45e-04       3.37e-03      -1.13461178543171663478e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  113       1.46e-04       3.32e-03      -1.13461145323278597061e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  114       1.47e-04       3.28e-03      -1.13461112544835632434e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  115       1.48e-04       3.23e-03      -1.13461080197672654322e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  116       1.48e-04       3.19e-03      -1.13461048272115967848e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  117       1.49e-04       3.15e-03      -1.13461016758959467552e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  118       1.50e-04       3.11e-03      -1.13460985649437061511e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  119       1.50e-04       3.07e-03      -1.13460954935197078157e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  120       1.50e-04       3.03e-03      -1.13460924608278055530e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  121       1.51e-04       2.99e-03      -1.13460894661085912958e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  122       1.51e-04       2.96e-03      -1.13460865086372159567e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  123       1.51e-04       2.92e-03      -1.13460835877214140055e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  124       1.51e-04       2.89e-03      -1.13460807026995498745e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  125       1.51e-04       2.85e-03      -1.13460778529388408060e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  126       1.51e-04       2.82e-03      -1.13460750378336724680e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  127       1.50e-04       2.78e-03      -1.13460722568039709586e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  128       1.50e-04       2.75e-03      -1.13460695092937457957e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  129       1.50e-04       2.71e-03      -1.13460667947696310875e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  130       1.49e-04       2.68e-03      -1.13460641127195776789e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  131       1.49e-04       2.65e-03      -1.13460614626515998680e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  132       1.49e-04       2.62e-03      -1.13460588440925548639e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  133       1.48e-04       2.59e-03      -1.13460562565870804974e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  134       1.47e-04       2.56e-03      -1.13460536996965020080e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  135       1.47e-04       2.53e-03      -1.13460511729978443327e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  136       1.46e-04       2.50e-03      -1.13460486760829226114e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  137       1.45e-04       2.47e-03      -1.13460462085574436060e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  138       1.45e-04       2.44e-03      -1.13460437700401598704e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  139       1.44e-04       2.41e-03      -1.13460413601621185080e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  140       1.43e-04       2.38e-03      -1.13460389785659099289e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  141       1.42e-04       2.35e-03      -1.13460366249049620819e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  142       1.41e-04       2.33e-03      -1.13460342988429001707e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  143       1.40e-04       2.30e-03      -1.13460320000529100071e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  144       1.39e-04       2.27e-03      -1.13460297282171795814e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  145       1.38e-04       2.25e-03      -1.13460274830263297190e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  146       1.37e-04       2.22e-03      -1.13460252641788993060e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  147       1.36e-04       2.19e-03      -1.13460230713808668952e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  148       1.35e-04       2.17e-03      -1.13460209043451941398e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  149       1.34e-04       2.14e-03      -1.13460187627913692268e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  150       1.33e-04       2.12e-03      -1.13460166464450176136e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  151       1.32e-04       2.09e-03      -1.13460145550375273160e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  152       1.31e-04       2.07e-03      -1.13460124883056687395e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  153       1.30e-04       2.04e-03      -1.13460104459912581660e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  154       1.29e-04       2.02e-03      -1.13460084278408448881e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  155       1.28e-04       1.99e-03      -1.13460064336054219893e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  156       1.27e-04       1.97e-03      -1.13460044630401116592e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  157       1.25e-04       1.95e-03      -1.13460025159039360005e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  158       1.24e-04       1.92e-03      -1.13460005919595405430e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  159       1.23e-04       1.90e-03      -1.13459986909729850595e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  160       1.22e-04       1.88e-03      -1.13459968127135070972e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  161       1.21e-04       1.86e-03      -1.13459949569533200702e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  162       1.19e-04       1.83e-03      -1.13459931234674386360e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  163       1.18e-04       1.81e-03      -1.13459913120334786072e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  164       1.17e-04       1.79e-03      -1.13459895224315023370e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  165       1.16e-04       1.77e-03      -1.13459877544438604673e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  166       1.14e-04       1.75e-03      -1.13459860078550482285e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  167       1.13e-04       1.73e-03      -1.13459842824515744724e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  168       1.12e-04       1.70e-03      -1.13459825780218197906e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  169       1.11e-04       1.68e-03      -1.13459808943559455656e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  170       1.09e-04       1.66e-03      -1.13459792312457830121e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  171       1.08e-04       1.64e-03      -1.13459775884847003908e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  172       1.07e-04       1.62e-03      -1.13459759658675611718e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  173       1.06e-04       1.60e-03      -1.13459743631906167138e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  174       1.05e-04       1.58e-03      -1.13459727802514189534e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  175       1.03e-04       1.56e-03      -1.13459712168487676536e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  176       1.02e-04       1.54e-03      -1.13459696727826503775e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  177       1.01e-04       1.52e-03      -1.13459681478541679098e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  178       9.98e-05       1.51e-03      -1.13459666418654851441e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Processing the outputs... Done!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mr.mash successfully executed in 0.0708061 minutes!</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare the "fitted" values of Y against the true Y in the training set.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">fitted</span>,<span class="va">Ytrain</span>,pch <span class="op">=</span> <span class="fl">20</span>,col <span class="op">=</span> <span class="st">"darkblue"</span>,xlab <span class="op">=</span> <span class="st">"true"</span>,</span></span>
<span class="r-in"><span>     ylab <span class="op">=</span> <span class="st">"fitted"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">0</span>,b <span class="op">=</span> <span class="fl">1</span>,col <span class="op">=</span> <span class="st">"magenta"</span>,lty <span class="op">=</span> <span class="st">"dotted"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="mr.mash-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Predict the multivariate outcomes in the test set using the fitted model.</span></span></span>
<span class="r-in"><span><span class="va">Ytest_est</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit</span>,<span class="va">Xtest</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Ytest_est</span>,<span class="va">Ytest</span>,pch <span class="op">=</span> <span class="fl">20</span>,col <span class="op">=</span> <span class="st">"darkblue"</span>,xlab <span class="op">=</span> <span class="st">"true"</span>,</span></span>
<span class="r-in"><span>     ylab <span class="op">=</span> <span class="st">"predicted"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">0</span>,b <span class="op">=</span> <span class="fl">1</span>,col <span class="op">=</span> <span class="st">"magenta"</span>,lty <span class="op">=</span> <span class="st">"dotted"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="mr.mash-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Fabio Morgante, Peter Carbonetto, Matthew Stephens.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

